<div class="profile-settings">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <mat-spinner></mat-spinner>
    <p>جاري تحميل الإعدادات...</p>
  </div>

  <!-- Settings Form -->
  <div *ngIf="!isLoading" class="settings-content">
    <form [formGroup]="profileForm" (ngSubmit)="onSubmit()" class="settings-form">
      
      <!-- Basic Information -->
      <mat-card class="settings-card">
        <mat-card-header>
          <mat-card-title>المعلومات الأساسية</mat-card-title>
          <mat-card-subtitle>قم بتحديث معلوماتك الشخصية</mat-card-subtitle>
        </mat-card-header>
        
        <mat-card-content>
          <div class="form-section">
            <div class="form-row">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>الاسم الكامل</mat-label>
                <input matInput formControlName="fullName" placeholder="أدخل اسمك الكامل">
                <mat-icon matPrefix>
                  <lucide-icon name="user" size="20"></lucide-icon>
                </mat-icon>
                <mat-error *ngIf="profileForm.get('fullName')?.hasError('required')">
                  الاسم الكامل مطلوب
                </mat-error>
                <mat-error *ngIf="profileForm.get('fullName')?.hasError('minlength')">
                  الاسم يجب أن يكون حرفين على الأقل
                </mat-error>
              </mat-form-field>
            </div>

            <div class="form-row">
              <mat-form-field appearance="outline" class="half-width">
                <mat-label>البريد الإلكتروني</mat-label>
                <input matInput formControlName="email" placeholder="أدخل بريدك الإلكتروني" readonly>
                <mat-icon matPrefix>
                  <lucide-icon name="mail" size="20"></lucide-icon>
                </mat-icon>
                <mat-hint>لا يمكن تغيير البريد الإلكتروني</mat-hint>
              </mat-form-field>

              <mat-form-field appearance="outline" class="half-width">
                <mat-label>رقم الهاتف</mat-label>
                <input matInput formControlName="phoneNumber" placeholder="أدخل رقم هاتفك">
                <mat-icon matPrefix>
                  <lucide-icon name="phone" size="20"></lucide-icon>
                </mat-icon>
              </mat-form-field>
            </div>

            <div class="form-row">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>الموقع</mat-label>
                <input matInput formControlName="location" placeholder="أدخل موقعك">
                <mat-icon matPrefix>
                  <lucide-icon name="map-pin" size="20"></lucide-icon>
                </mat-icon>
              </mat-form-field>
            </div>

            <div class="form-row">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>نبذة شخصية</mat-label>
                <textarea 
                  matInput 
                  formControlName="bio" 
                  placeholder="اكتب نبذة شخصية عنك"
                  rows="3">
                </textarea>
              </mat-form-field>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Language & Region -->
      <mat-card class="settings-card">
        <mat-card-header>
          <mat-card-title>اللغة والمنطقة</mat-card-title>
          <mat-card-subtitle>اختر لغتك المفضلة والمنطقة الزمنية</mat-card-subtitle>
        </mat-card-header>
        
        <mat-card-content>
          <div class="form-section">
            <div class="form-row">
              <mat-form-field appearance="outline" class="half-width">
                <mat-label>اللغة</mat-label>
                <mat-select formControlName="language">
                  <mat-option *ngFor="let lang of languages" [value]="lang.value">
                    {{ lang.label }}
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field appearance="outline" class="half-width">
                <mat-label>المنطقة الزمنية</mat-label>
                <mat-select formControlName="timezone">
                  <mat-option *ngFor="let tz of timezones" [value]="tz.value">
                    {{ tz.label }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Social Links -->
      <mat-card class="settings-card">
        <mat-card-header>
          <mat-card-title>الروابط الاجتماعية</mat-card-title>
          <mat-card-subtitle>أضف روابط حساباتك الاجتماعية</mat-card-subtitle>
        </mat-card-header>
        
        <mat-card-content>
          <div class="form-section" formGroupName="socialLinks">
            <div class="form-row">
              <mat-form-field appearance="outline" class="half-width">
                <mat-label>تويتر</mat-label>
                <input matInput formControlName="twitter" placeholder="https://twitter.com/username">
              </mat-form-field>

              <mat-form-field appearance="outline" class="half-width">
                <mat-label>إنستغرام</mat-label>
                <input matInput formControlName="instagram" placeholder="https://instagram.com/username">
              </mat-form-field>
            </div>

            <div class="form-row">
              <mat-form-field appearance="outline" class="half-width">
                <mat-label>لينكد إن</mat-label>
                <input matInput formControlName="linkedin" placeholder="https://linkedin.com/in/username">
              </mat-form-field>

              <mat-form-field appearance="outline" class="half-width">
                <mat-label>فيسبوك</mat-label>
                <input matInput formControlName="facebook" placeholder="https://facebook.com/username">
              </mat-form-field>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Notification Preferences -->
      <mat-card class="settings-card">
        <mat-card-header>
          <mat-card-title>تفضيلات الإشعارات</mat-card-title>
          <mat-card-subtitle>اختر كيف تريد تلقي الإشعارات</mat-card-subtitle>
        </mat-card-header>
        
        <mat-card-content>
          <div class="form-section" formGroupName="preferences">
            <div class="preferences-grid">
              <div class="preference-item">
                <mat-checkbox formControlName="emailNotifications">
                  الإشعارات عبر البريد الإلكتروني
                </mat-checkbox>
                <p class="preference-description">تلقي إشعارات مهمة عبر البريد الإلكتروني</p>
              </div>

              <div class="preference-item">
                <mat-checkbox formControlName="smsNotifications">
                  الإشعارات عبر الرسائل النصية
                </mat-checkbox>
                <p class="preference-description">تلقي إشعارات عاجلة عبر الرسائل النصية</p>
              </div>

              <div class="preference-item">
                <mat-checkbox formControlName="pushNotifications">
                  الإشعارات المنبثقة
                </mat-checkbox>
                <p class="preference-description">تلقي إشعارات في المتصفح</p>
              </div>

              <div class="preference-item">
                <mat-checkbox formControlName="marketingEmails">
                  رسائل التسويق
                </mat-checkbox>
                <p class="preference-description">تلقي عروض ورسائل تسويقية</p>
              </div>

              <div class="preference-item">
                <mat-checkbox formControlName="weeklyDigest">
                  التلخيص الأسبوعي
                </mat-checkbox>
                <p class="preference-description">تلقي ملخص أسبوعي لأنشطتك</p>
              </div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Action Buttons -->
      <div class="action-buttons">
        <button mat-stroked-button type="button" (click)="onReset()" [disabled]="isSaving">
          إعادة تعيين
        </button>
        <button 
          mat-raised-button 
          color="primary" 
          type="submit" 
          [disabled]="profileForm.invalid || isSaving">
          <mat-spinner *ngIf="isSaving" diameter="20" class="me-2"></mat-spinner>
          <lucide-icon *ngIf="!isSaving" name="save" size="18" class="me-2"></lucide-icon>
          {{ isSaving ? 'جاري الحفظ...' : 'حفظ التغييرات' }}
        </button>
      </div>
    </form>
  </div>
</div>
